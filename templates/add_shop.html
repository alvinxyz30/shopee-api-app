{% extends "base.html" %}

{% block title %}Tambah Toko - Shopee API Integration{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">
            <i class="fas fa-plus"></i> Tambah Toko Baru
        </h1>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-store"></i> Informasi Toko Shopee
                </h5>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('auth_shop') }}">
                    <div class="mb-3">
                        <label for="shop_account" class="form-label">Shop Account *</label>
                        <input type="text" class="form-control" id="shop_account" name="shop_account" 
                               placeholder="Contoh: SANDBOX.2cd0a6e7d69d9f56cf00" required>
                        <div class="form-text">
                            Masukkan Shop Account yang diberikan Shopee untuk testing atau production.
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="shop_password" class="form-label">Shop Password *</label>
                        <input type="password" class="form-control" id="shop_password" name="shop_password" 
                               placeholder="Masukkan password shop" required>
                        <div class="form-text">
                            Password untuk Shop Account yang diberikan Shopee.
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            <strong>Proses Autentikasi:</strong><br>
                            1. Masukkan Shop Account dan Password<br>
                            2. Klik "Mulai Autentikasi"<br>
                            3. Anda akan diarahkan ke halaman login Shopee<br>
                            4. Login dengan credentials yang sudah diisi<br>
                            5. Konfirmasi otorisasi aplikasi<br>
                            6. Anda akan kembali ke aplikasi dengan toko yang sudah terintegrasi
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-sign-in-alt"></i> Mulai Autentikasi
                        </button>
                        <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left"></i> Kembali
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <!-- Test Data Card -->
        <div class="card">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="fas fa-vial"></i> Data Testing
                </h6>
            </div>
            <div class="card-body">
                <p class="card-text">
                    <strong>Test Shop Account:</strong><br>
                    <code>SANDBOX.2cd0a6e7d69d9f56cf00</code>
                </p>
                <p class="card-text">
                    <strong>Test Shop Password:</strong><br>
                    <code>9528728e1dd6c63d</code>
                </p>
                <p class="card-text">
                    <strong>Test Shop ID:</strong><br>
                    <code>225535624</code>
                </p>
                <button class="btn btn-outline-primary btn-sm" onclick="fillTestData()">
                    <i class="fas fa-copy"></i> Isi Data Test
                </button>
            </div>
        </div>
        
        <!-- Help Card -->
        <div class="card mt-3">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="fas fa-question-circle"></i> Bantuan
                </h6>
            </div>
            <div class="card-body">
                <p class="card-text">
                    <strong>Dimana mendapatkan Shop Account?</strong><br>
                    Shop Account dan Password diberikan oleh Shopee melalui Open Platform developer portal.
                </p>
                <p class="card-text">
                    <strong>Aplikasi tidak bisa autentikasi?</strong><br>
                    Pastikan credentials yang dimasukkan benar dan akun memiliki akses ke Open Platform API.
                </p>
                <p class="card-text">
                    <strong>Batas maksimal toko?</strong><br>
                    Aplikasi ini mendukung maksimal 10 toko per instalasi.
                </p>
            </div>
        </div>
        
        <!-- API Configuration -->
        <div class="card mt-3">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="fas fa-cog"></i> Konfigurasi API
                </h6>
            </div>
            <div class="card-body">
                <p class="card-text">
                    <strong>Partner ID:</strong><br>
                    <code>{{ config.SHOPEE_PARTNER_ID }}</code>
                </p>
                <p class="card-text">
                    <strong>Base URL:</strong><br>
                    <code>{{ config.SHOPEE_BASE_URL }}</code>
                </p>
                <p class="card-text">
                    <strong>Redirect URL:</strong><br>
                    <code>{{ config.SHOPEE_REDIRECT_URL }}</code>
                </p>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
function fillTestData() {
    document.getElementById('shop_account').value = 'SANDBOX.2cd0a6e7d69d9f56cf00';
    document.getElementById('shop_password').value = '9528728e1dd6c63d';
}

// Validate form before submit
document.querySelector('form').addEventListener('submit', function(e) {
    var shopAccount = document.getElementById('shop_account').value.trim();
    var shopPassword = document.getElementById('shop_password').value.trim();
    
    if (!shopAccount || !shopPassword) {
        e.preventDefault();
        alert('Shop Account dan Password harus diisi!');
        return false;
    }
    
    // Show loading state
    var submitBtn = this.querySelector('button[type="submit"]');
    submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status"></span> Memproses...';
    submitBtn.disabled = true;
});
</script>
{% endblock %}